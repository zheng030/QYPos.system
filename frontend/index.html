<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>POS 點餐系統</title>
    <link rel="stylesheet" href="style.css?v=6">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body ontouchstart="">

    <div id="receipt-print-area"></div>
    <div id="toast-container"></div>

    <div id="login-screen">
        <div class="login-box">
            <h1>🔐 系統登入</h1>
            <p>請輸入員工密碼</p>
            <input type="password" id="loginPass" placeholder="密碼" onkeydown="if(event.keyCode==13) checkLogin()">
            <button onclick="checkLogin()" class="btn-effect">進入系統</button>
            <p id="loginError" style="color:#ef476f; display:none; margin-top:10px;">❌ 密碼錯誤</p>
        </div>
    </div>

    <div id="app-container" style="display:none;">
        
        <div id="home">
            <div class="menu-btn" onclick="openTableSelect()">
                <span style="font-size: 32px;">🛒</span>
                <span>點餐系統</span>
            </div>
            <div class="menu-btn" onclick="openPage('historyPage')">
                <span style="font-size: 32px;">📋</span>
                <span>今日訂單</span>
            </div>
            <div class="menu-btn" onclick="openPage('reportPage')">
                <span style="font-size: 32px;">📊</span>
                <span>營業報表</span>
            </div>

            <div class="menu-btn" onclick="openOwnerLogin('cost')">
                <span style="font-size: 32px;">🤫</span>
                <span>機密 (輸入成本)</span>
            </div>
            <div class="menu-btn" onclick="openOwnerLogin('finance')">
                <span style="font-size: 32px;">🔐</span>
                <span>權限 (財務/詳單)</span>
            </div>
            <div class="menu-btn" onclick="openSettingsPage()">
                <span style="font-size: 32px;">🛠️</span>
                <span>系統設定</span>
            </div>

            <div class="menu-btn">
                <span style="font-size: 32px;">📦</span>
                <span>商品上架</span>
            </div>
            <div class="menu-btn" onclick="openItemStatsModal()">
                <span style="font-size: 32px;">📈</span>
                <span>歷史銷量</span>
            </div>
            <div class="menu-btn">
                <span style="font-size: 32px;">🔍</span>
                <span>商品搜尋</span>
            </div>
        </div>

        <div id="tableSelect">
            <div class="header-row">
                <button class="back btn-effect" onclick="goHome()">⬅ 返回主畫面</button>
                <button class="btn-effect" onclick="toggleQrMode()" style="background: #6610f2; color: white; padding: 10px 20px; border-radius: 50px; font-weight: bold; font-size: 15px; box-shadow: 0 4px 10px rgba(102,16,242,0.3);">
                    📲 顯示 QR Code
                </button>
                <div id="systemTime">載入中...</div>
            </div>
            <div class="title">請選擇座位</div>
            <div id="tableSelectGrid"></div>
        </div>

        <div id="orderPage">
            <div class="order-header">
                <button class="back btn-effect" onclick="saveAndExit()">⬅ 取消 / 返回</button>
                <div class="title-group">
                    <span class="title" style="border:none; padding:0; margin:0;">🛒 點餐中 <span id="seatLabel"></span></span>
                    <div id="seatTimer"></div>
                </div>
            </div>
            
            <div class="customer-input-box">
                <input type="text" id="custName" placeholder="輸入客人姓名">
                <input type="tel" id="custPhone" placeholder="輸入電話號碼">
            </div>

            <div id="menuGrid"></div> 

            <div id="cart-container">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <h2 style="margin:0; font-size: 20px; color: #2b2d42;">🧾 訂單明細</h2>
                    <button onclick="toggleCartView()" class="btn-effect" style="background:#e2e8f0; color:#475569; border-radius:20px; padding:6px 15px; font-size:14px; font-weight:bold;">
                        👁️ 切換視圖
                    </button>
                </div>
                
                <div id="cart-list"></div>
                
                <div class="summary-section">
                    <div class="summary-controls">
                        <button id="svcBtn" class="control-btn btn-effect" onclick="toggleServiceFee()">
                            ◻️ 收 10% 服務費
                        </button>
                        <button class="control-btn btn-effect" onclick="openDiscountModal()">
                            % 設定折扣
                        </button>
                    </div>
            
                    <div class="total-display">
                        <p id="total">總金額：0 元</p>
                    </div>
                </div>
                
                <div class="action-buttons-compact">
                    <button class="action-btn save-btn btn-effect" onclick="saveOrderManual()">📝 暫存</button>
                    <button class="action-btn reprint-btn btn-effect" onclick="openReprintModal()">🖨 補單</button>
                    <button class="action-btn checkout-btn btn-effect" onclick="openPaymentModal()">💰 全結</button>
                    <button class="action-btn split-btn btn-effect" onclick="openSplitCheckout()">✂ 拆單</button>
                </div>
            </div>
        </div>

        <div id="historyPage">
            <button class="back btn-effect" onclick="goHome()">⬅ 返回主畫面</button>
            <div class="title">📋 今日訂單列表</div>
            <div class="history-header-row">
                <span>序號</span><span>桌號</span><span>客人資訊</span><span>時間</span><span>金額</span>
            </div>
            <div id="history-box"></div>
            <button onclick="closeBusiness()" class="end-business-btn btn-effect">🛑 結束營業 (日結)</button>
        </div>

        <div id="pastHistoryPage" style="display:none;">
            <button class="back btn-effect" onclick="goHome()">⬅ 返回主畫面</button>
            <div class="title">📜 歷史銷售統計 (月報)</div>
            <div class="calendar-wrapper" style="margin-bottom: 20px;">
                <div class="calendar-header" style="display: flex; justify-content: space-between; align-items: center; padding: 0 20px;">
                    <button onclick="changeStatsMonth(-1)" class="btn-effect" style="background:#e9ecef; border-radius:50%; width:40px; height:40px; font-weight:bold;">◀</button>
                    <h2 id="statsMonthTitle" style="margin:0;"></h2>
                    <button onclick="changeStatsMonth(1)" class="btn-effect" style="background:#e9ecef; border-radius:50%; width:40px; height:40px; font-weight:bold;">▶</button>
                </div>
            </div>
            <div class="stats-body">
                <div class="stats-column">
                    <h3>🍺 酒吧部銷量</h3>
                    <div class="stats-header-row"><span>品項</span><span>數量</span></div>
                    <div id="publicStatsBar"></div>
                </div>
                <div class="stats-column">
                    <h3>🍖 燒烤部銷量</h3>
                    <div class="stats-header-row"><span>品項</span><span>數量</span></div>
                    <div id="publicStatsBbq"></div>
                </div>
            </div>
        </div>

        <div id="reportPage">
            <button class="back btn-effect" onclick="goHome()">⬅ 返回主畫面</button>
            <div class="title">📊 營業報表</div>
            
            <div id="reportContent">
                <div class="segment-control-wrapper">
                    <div class="segment-control-container">
                        <div class="segment-highlighter" id="reportHighlighter"></div>
                        <div class="segment-option active" onclick="generateReport('day')">今日</div>
                        <div class="segment-option" onclick="generateReport('week')">本周</div>
                        <div class="segment-option" onclick="generateReport('month')">當月</div>
                    </div>
                </div>

                <div class="report-dashboard">
                    <div class="stat-card total-gradient">
                        <div class="card-icon">💰</div>
                        <h3 id="rptTitle">今日營業額</h3>
                        <p id="rptTotal">$0</p>
                        <small id="rptCount">總單數: 0</small>
                    </div>
                    <div class="stat-card bar-gradient">
                        <div class="card-icon">🍺</div>
                        <h3>酒吧部營收</h3>
                        <p id="rptBar">$0</p>
                        <small>調酒/純飲/啤酒/飲料</small>
                    </div>
                    <div class="stat-card bbq-gradient">
                        <div class="card-icon">🍖</div>
                        <h3>燒烤部營收</h3>
                        <p id="rptBBQ">$0</p>
                        <small>燒烤/主餐/炸物</small>
                    </div>
                </div>
            </div>

            <div class="calendar-wrapper">
                <div class="calendar-header"><h2 id="calendarMonthTitle"></h2></div>
                <div class="calendar-grid-header">
                    <span>日</span><span>一</span><span>二</span><span>三</span><span>四</span><span>五</span><span>六</span>
                </div>
                <div id="calendarGrid" class="calendar-grid"></div>
            </div>
            <div style="margin-top:20px; color:#888; font-size:14px;">* 統計時間以「營業日」計算 (凌晨5點前算前一日)</div>
        </div>

        <div id="confidentialPage">
            <button class="back btn-effect" onclick="goHome()">⬅ 返回主畫面</button>
            <div class="title">🤫 <span id="ownerWelcome"></span> <span id="confidentialTitle"></span></div>
            <div id="financeDashboard" class="finance-container" style="display:none;"></div>
            <div id="financeCalendarSection" style="display:none;">
                <div class="calendar-header" style="display: flex; justify-content: space-between; align-items: center; padding: 0 10px; margin-bottom: 15px;">
                    <button onclick="changeOwnerMonth(-1)" class="btn-effect" style="background:#e9ecef; border-radius:50%; width:40px; height:40px; font-weight:bold;">◀</button>
                    <h2 id="finCalendarTitle" style="margin:0; font-size:22px;"></h2>
                    <button onclick="changeOwnerMonth(1)" class="btn-effect" style="background:#e9ecef; border-radius:50%; width:40px; height:40px; font-weight:bold;">▶</button>
                </div>
                <div class="finance-layout">
                    <div class="calendar-container-left">
                        <div class="calendar-grid-header">
                            <span>日</span><span>一</span><span>二</span><span>三</span><span>四</span><span>五</span><span>六</span>
                        </div>
                        <div id="finCalendarGrid" class="calendar-grid"></div>
                        <div style="text-align:center; color:#007bff; font-size:14px; margin-top:10px; font-weight:bold;">(💡 點擊日期可查看當日詳細訂單)</div>
                    </div>
                    <div class="finance-summary-sidebar">
                        <div class="finance-controls">
                            <button onclick="updateFinanceStats('day')" id="finBtnDay" class="btn-effect">今日</button>
                            <button onclick="updateFinanceStats('week')" id="finBtnWeek" class="btn-effect">本周</button>
                            <button onclick="updateFinanceStats('month')" id="finBtnMonth" class="btn-effect active">當月</button>
                        </div>
                        <div class="summary-card total-theme">
                            <h3 id="financeTitle">🏠 全店總計 (本月)</h3>
                            <div class="sum-row"><span>總營收</span><span id="monthTotalRev">$0</span></div>
                            <div class="sum-row"><span>總成本</span><span id="monthTotalCost" class="cost-text">$0</span></div>
                            <hr>
                            <div class="sum-row highlight"><span>淨利潤</span><span id="monthTotalProfit">$0</span></div>
                        </div>
                        <div class="summary-card bar-theme">
                            <h3>🍺 酒吧部</h3>
                            <div class="sum-row"><span>營收</span><span id="monthBarRev">$0</span></div>
                            <div class="sum-row"><span>成本</span><span id="monthBarCost" class="cost-text">$0</span></div>
                            <hr>
                            <div class="sum-row highlight"><span>毛利</span><span id="monthBarProfit">$0</span></div>
                        </div>
                        <div class="summary-card bbq-theme">
                            <h3>🍖 燒烤部</h3>
                            <div class="sum-row"><span>營收</span><span id="monthBbqRev">$0</span></div>
                            <div class="sum-row"><span>成本</span><span id="monthBbqCost" class="cost-text">$0</span></div>
                            <hr>
                            <div class="sum-row highlight"><span>毛利</span><span id="monthBbqProfit">$0</span></div>
                        </div>
                    </div>
                </div>
                <div id="ownerOrderListSection" style="margin-top:20px; display:none;">
                    <h3 id="ownerSelectedDateTitle" style="border-bottom: 2px solid #007bff; padding-bottom: 10px; color:#007bff;"></h3>
                    <div class="history-header-row" style="grid-template-columns: 0.5fr 0.8fr 2fr 0.8fr 0.8fr auto !important;">
                        <span>#</span><span>桌號</span><span>內容</span><span>時間</span><span>金額</span><span>操作</span>
                    </div>
                    <div id="ownerOrderBox"></div>
                </div>
            </div>
            <div id="costInputSection" class="finance-detail-box" style="display:none;">
                <h3 id="costEditTitle">📝 成本輸入</h3>
                <div class="cost-header-row">
                    <span>品項名稱</span>
                    <span style="text-align:right;">售價 (改)</span>
                    <span style="text-align:right;">成本 (改)</span>
                </div>
                <div id="costEditorList"></div>
            </div>
        </div>

        <div id="settingsPage">
            <button class="back btn-effect" onclick="goHome()">⬅ 返回主畫面</button>
            <div class="title">🛠 系統設定 (修改密碼)</div>
            <div class="owner-buttons">
                <button onclick="openChangePasswordModal('景偉')" class="btn-effect owner-btn">🔑 修改 景偉 密碼</button>
                <button onclick="openChangePasswordModal('小飛')" class="btn-effect owner-btn">🔑 修改 小飛 密碼</button>
                <button onclick="openChangePasswordModal('威志')" class="btn-effect owner-btn">🔑 修改 威志 密碼</button>
            </div>
            <div style="margin-top: 50px; padding-top: 20px; border-top: 2px dashed #ccc;">
                <h3 style="color:#dc3545;">⚠️ 危險專區</h3>
                <button onclick="fixAllOrderIds()" class="btn-effect" style="width:100%; padding:15px; font-size:18px; background:#17a2b8; color:white; border-radius:10px; font-weight:bold; margin-bottom:15px;">🔄 一鍵重整歷史單號</button>
                <button onclick="clearAllData()" class="btn-effect" style="width:100%; padding:15px; font-size:18px; background:#dc3545; color:white; border-radius:10px; font-weight:bold;">🗑️ 一鍵清空所有訂單</button>
            </div>
        </div>

        <div id="summaryModal" class="modal"><div class="modal-content"><h2>📅 本日營業結算</h2><div class="summary-item"><span>📦 總訂單數</span><span id="sumCount">0 單</span></div><div class="summary-item"><span>💰 營業總額</span><span id="sumTotal" style="color:#ef476f;">$0</span></div><hr><p style="color:#666; font-size:14px;">確認後將完成日結，資料會自動寫入報表。</p><div class="modal-actions"><button onclick="closeSummaryModal()" class="btn-effect cancel">取消</button><button onclick="confirmClearData()" class="btn-effect confirm-success">✅ 確認日結</button></div></div></div>
        <div id="paymentModal" class="modal"><div class="modal-content"><h2>💰 結帳確認</h2><div class="payment-info"><div class="pay-row"><span>應收金額 <small id="payDiscLabel" style="color:#888;"></small>：</span><span id="payOriginal" style="font-weight:bold;">$0</span></div><div class="pay-row"><span>$ 折讓/抹零：</span><input type="number" id="payAllowance" value="" oninput="calcFinalPay()" placeholder="輸入金額" style="color:#ef476f;" class="modal-input big-input"></div><hr><div class="pay-row large"><span>實收金額：</span><input type="number" id="payFinal" style="color:#ef476f; font-weight:bold;" class="modal-input big-input"></div></div><div class="modal-actions"><button onclick="closePaymentModal()" class="btn-effect cancel">取消</button><button onclick="confirmCheckout()" class="btn-effect confirm-success">✅ 確認收款</button></div></div></div>
        <div id="checkoutModal" class="modal"><div class="modal-content" style="max-width:900px;"><div class="modal-header"><h2>✂ 拆單結帳</h2></div><div class="modal-body"><p style="color:#666; margin-bottom: 15px;">點擊左邊品項移至右邊進行結帳</p><div class="split-checkout-container"><div class="checkout-box left-box"><h3>📦 未結帳品項</h3><div id="unpaidList" class="checkout-list"></div></div><div class="split-arrow">➡</div><div class="checkout-box right-box"><h3>💳 本次結帳</h3><div id="payingList" class="checkout-list"></div><div class="split-options"><input type="number" id="splitDisc" placeholder="% 折扣" oninput="calcSplitTotal()" class="split-input"><input type="number" id="splitAllow" placeholder="$ 折讓" oninput="calcSplitTotal()" class="split-input"></div><div class="checkout-total">總計: <span id="payTotal">$0</span></div></div></div></div><div class="modal-actions"><button onclick="closeCheckoutModal()" class="btn-effect cancel">取消</button><button onclick="confirmPayment()" class="btn-effect confirm-success">✅ 確認結帳</button></div></div></div>
        <div id="reprintSelectionModal" class="modal"><div class="modal-content" style="max-width:400px;"><div class="modal-header"><h2>🖨 選擇補單項目</h2></div><div class="modal-body" style="max-height:400px; overflow-y:auto;"><p style="color:#666; font-size:14px; margin-bottom:10px;">請勾選要列印的項目：</p><div id="reprintList"></div></div><div class="modal-actions"><button onclick="closeReprintModal()" class="btn-effect cancel">取消</button><button onclick="confirmReprintSelection()" class="btn-effect confirm-success">✅ 確認列印</button></div></div></div>
        <div id="ownerLoginModal" class="modal"><div class="modal-content"><div class="modal-header"><h2>🔐 請選擇身分</h2></div><div class="modal-body" style="padding-top: 20px;"><div class="owner-buttons"><button onclick="checkOwner('景偉')" class="btn-effect owner-btn">👨‍💼 景偉 (總管)</button><button onclick="checkOwner('小飛')" class="btn-effect owner-btn">🍸 小飛 (酒吧)</button><button onclick="checkOwner('威志')" class="btn-effect owner-btn">🍖 威志 (燒烤)</button></div></div><button onclick="closeOwnerModal()" class="btn-effect owner-cancel-btn">取消</button></div></div>
        <div id="changePasswordModal" class="modal"><div class="modal-content"><h2>🔑 修改密碼 - <span id="pwdOwnerName"></span></h2><div style="margin-top:15px;"><input type="password" id="oldPwd" placeholder="輸入舊密碼" class="pwd-input modal-input"><input type="password" id="newPwd" placeholder="輸入新密碼" class="pwd-input modal-input"><input type="password" id="confirmPwd" placeholder="再次確認新密碼" class="pwd-input modal-input"></div><div class="modal-actions"><button onclick="closeChangePasswordModal()" class="btn-effect cancel">取消</button><button onclick="confirmChangePassword()" class="btn-effect confirm-primary">✅ 確認修改</button></div></div></div>
        <div id="discountModal" class="modal"><div class="modal-content"><div class="modal-header"><h2>% 折扣設定</h2></div><div class="modal-body" style="text-align: center; padding: 30px 0;"><div style="display: flex; justify-content: center; align-items: center; gap: 10px; margin-bottom: 15px;"><input type="number" id="discInput" placeholder="輸入折扣額度" class="modal-input big-input" style="width: 200px; text-align:center;" oninput="updateDiscPreview()"> <span style="font-size: 24px; font-weight: bold; color: #555;">%</span></div><p id="discPreviewText" style="color: #06d6a0; font-weight: bold; font-size: 18px; min-height: 27px;"></p></div><div class="modal-actions"><button onclick="closeDiscountModal()" class="btn-effect cancel">取消</button><button onclick="confirmDiscount()" class="btn-effect confirm-warning">確定</button></div></div></div>
        <div id="allowanceModal" class="modal"><div class="modal-content"><div class="modal-header"><h2>$ 金額折讓</h2></div><div class="modal-body" style="text-align:center; padding:30px 0;"><p style="font-size:18px; color:#555; margin-bottom:15px;">選擇折讓金額</p><div style="display:flex; justify-content:center; align-items:center; gap:10px;"><span style="font-size:24px; color:#ef476f;">- $</span><input type="number" id="allowInput" placeholder="輸入金額" class="modal-input big-input" style="width:160px; text-align:center;"></div></div><div class="modal-actions"><button onclick="closeAllowanceModal()" class="btn-effect cancel">取消</button><button onclick="confirmAllowance()" class="btn-effect confirm-primary">確定</button></div></div></div>
        <div id="financeDetailModal" class="modal"><div class="modal-content"><div class="modal-header"><h2 id="fdTitle">📅 財務明細</h2></div><div class="modal-body"><div class="fin-detail-card bar-style"><h3>🍺 酒吧部</h3><div class="fin-row"><span>營收</span><span id="fdBarRev">$0</span></div><div class="fin-row"><span>成本</span><span id="fdBarCost" class="red-text">$0</span></div><hr><div class="fin-row total"><span>毛利</span><span id="fdBarProfit">$0</span></div></div><div class="fin-detail-card bbq-style"><h3>🍖 燒烤部</h3><div class="fin-row"><span>營收</span><span id="fdBbqRev">$0</span></div><div class="fin-row"><span>成本</span><span id="fdBbqCost" class="red-text">$0</span></div><hr><div class="fin-row total"><span>毛利</span><span id="fdBbqProfit">$0</span></div></div><div class="fin-detail-card total-style"><h3>🏠 全店總計</h3><div class="fin-row"><span>總營收</span><span id="fdTotalRev">$0</span></div><div class="fin-row"><span>總成本</span><span id="fdTotalCost" class="red-text">$0</span></div><hr><div class="fin-row total large"><span>總淨利</span><span id="fdTotalProfit">$0</span></div></div></div><div class="modal-actions"><button onclick="closeFinanceDetailModal()" class="btn-effect" style="background:#6c757d; color:white;">關閉</button></div></div></div>
        <div id="itemStatsModal" class="modal"><div class="modal-content" style="max-width: 900px; height: 80vh; display: flex; flex-direction: column;"><div class="modal-header"><h2>📈 商品銷售統計</h2></div><div class="report-controls" style="margin-top: 15px;"><button onclick="renderItemStats('day')" id="statBtnDay" class="btn-effect active">今日</button><button onclick="renderItemStats('week')" id="statBtnWeek" class="btn-effect">本周</button><button onclick="renderItemStats('month')" id="statBtnMonth" class="btn-effect">當月</button></div><div class="stats-body" style="flex: 1; overflow-y: auto; display: flex; gap: 20px; padding: 10px;"><div class="stats-column"><h3 style="background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; padding: 10px; border-radius: 8px; margin-top:0;">🍺 酒吧部</h3><div class="stats-header-row"><span>品項</span><span>數量</span></div><div id="statsListBar"></div></div><div class="stats-column"><h3 style="background: linear-gradient(135deg, #ff9a9e, #fecfef); color: #333; padding: 10px; border-radius: 8px; margin-top:0;">🍖 燒烤部</h3><div class="stats-header-row"><span>品項</span><span>數量</span></div><div id="statsListBbq"></div></div></div><div class="modal-actions"><button onclick="closeItemStatsModal()" class="btn-effect" style="background:#6c757d; color:white;">關閉</button></div></div></div>
        <div id="customModal" class="modal"><div class="modal-content" style="text-align:left;"><div class="modal-header"><h2 style="text-align:center; margin:0;">🍹 <span id="customTitle">隱藏特調</span>客製化</h2></div><div class="modal-body"><div class="custom-section"><div class="custom-label">1. 香氣選擇</div><div class="radio-group"><label class="radio-box"><input type="radio" name="flavor" value="花香調" checked><div class="radio-btn btn-effect">花香調 🌸</div></label><label class="radio-box"><input type="radio" name="flavor" value="果香調"><div class="radio-btn btn-effect">果香調 🍎</div></label><label class="radio-box"><input type="radio" name="flavor" value="木質調"><div class="radio-btn btn-effect">木質調 🌲</div></label></div></div><div class="custom-section"><div class="custom-label">2. 口感偏好</div><div class="radio-group"><label class="radio-box"><input type="radio" name="taste" value="偏酸" checked><div class="radio-btn btn-effect">偏酸 🍋</div></label><label class="radio-box"><input type="radio" name="taste" value="偏甜"><div class="radio-btn btn-effect">偏甜 🍯</div></label><label class="radio-box"><input type="radio" name="taste" value="偏苦"><div class="radio-btn btn-effect">偏苦 ☕</div></label><label class="radio-box"><input type="radio" name="taste" value="偏鹹"><div class="radio-btn btn-effect">偏鹹 🧂</div></label></div></div><div id="modalAlcoholSection" class="custom-section"><div class="custom-label">3. 濃度調整 (<span id="alcoholVal">0</span>%)</div><input type="range" id="alcoholRange" min="0" max="100" step="10" value="0" style="width:100%; margin: 15px 0;" oninput="document.getElementById('alcoholVal').innerText=this.value"><div style="display:flex;justify-content:space-between;font-size:12px;color:#888; margin-bottom:10px;"><span>正常</span><span>加重</span><span>雙倍</span></div><button id="extraShotBtn" onclick="toggleExtraShot()" class="extra-shot-btn btn-effect">🍺 濃度升級 (+$40)</button></div><div id="modalNoteSection" class="custom-section" style="display:none;"><div class="custom-label">3. 備註 (選填)</div><textarea id="customNote" rows="2" placeholder="例如：少冰、不要裝飾..." class="modal-input" style="width:100%;"></textarea></div></div><div class="modal-actions"><button onclick="closeCustomModal()" class="btn-effect cancel">取消</button><button onclick="confirmCustomItem()" class="btn-effect confirm-success">✅ 確認加入</button></div></div></div>
        <div id="drinkModal" class="modal"><div class="modal-content" style="text-align:left;"><div class="modal-header"><h2 style="text-align:center; margin:0;">🥤 <span id="drinkTitle">飲料</span>選項</h2></div><div class="modal-body" style="padding-top: 20px;"><div id="simpleTempSection" class="custom-section" style="display:none;"><div class="custom-label">溫度選擇</div><div class="radio-group"><label class="radio-box"><input type="radio" name="simpleTemp" value="冰" checked><div class="radio-btn btn-effect">🧊 冰</div></label><label class="radio-box"><input type="radio" name="simpleTemp" value="熱"><div class="radio-btn btn-effect">🔥 熱</div></label></div></div><div id="advanceTempSection" class="custom-section" style="display:none;"><div class="custom-label">冰塊/溫度</div><div class="radio-group" style="font-size:14px;"><label class="radio-box"><input type="radio" name="advTemp" value="去冰" checked><div class="radio-btn btn-effect">去冰</div></label><label class="radio-box"><input type="radio" name="advTemp" value="微冰"><div class="radio-btn btn-effect">微冰</div></label><label class="radio-box"><input type="radio" name="advTemp" value="少冰"><div class="radio-btn btn-effect">少冰</div></label><label class="radio-box"><input type="radio" name="advTemp" value="溫"><div class="radio-btn btn-effect">溫</div></label><label class="radio-box"><input type="radio" name="advTemp" value="熱"><div class="radio-btn btn-effect">熱</div></label></div></div><div id="sugarSection" class="custom-section" style="display:none;"><div class="custom-label">甜度選擇</div><div class="radio-group"><label class="radio-box"><input type="radio" name="sugar" value="無糖" checked><div class="radio-btn btn-effect">無糖</div></label><label class="radio-box"><input type="radio" name="sugar" value="微糖"><div class="radio-btn btn-effect">微糖</div></label><label class="radio-box"><input type="radio" name="sugar" value="少糖"><div class="radio-btn btn-effect">少糖</div></label><label class="radio-box"><input type="radio" name="sugar" value="全糖"><div class="radio-btn btn-effect">全糖</div></label></div></div></div><div class="modal-actions"><button onclick="closeDrinkModal()" class="btn-effect cancel">取消</button><button onclick="confirmDrinkItem()" class="btn-effect confirm-success">✅ 確認加入</button></div></div></div>
        <div id="foodOptionModal" class="modal"><div class="modal-content" style="text-align:left;"><div class="modal-header"><h2 style="text-align:center; margin:0;">🍛 <span id="foodTitle">餐點</span>配料</h2></div><div class="modal-body" style="padding-top: 20px;"><div class="custom-section"><div class="custom-label">請選擇配料：</div><div class="radio-group nowrap" id="meatOptions"></div></div></div><div class="modal-actions"><button onclick="closeFoodModal()" class="btn-effect cancel">取消</button><button onclick="confirmFoodItem()" class="btn-effect confirm-success">✅ 確認加入</button></div></div></div>
        <div id="qrCodeModal" class="modal"><div class="modal-content" style="text-align: center;"><div class="modal-header"><h2>📲 客人點餐 QR Code</h2></div><div style="padding: 20px; display: flex; flex-direction: column; align-items: center;"><h3 id="qrTableTitle" style="color: #4361ee; margin-bottom: 10px;"></h3><div id="qrcode" style="margin: 10px auto;"></div><p style="color: #666; font-size: 14px; margin-top: 15px;">請客人掃描此碼即可開始點餐</p></div><div class="modal-actions"><button onclick="closeQrModal()" class="btn-effect" style="background:#6c757d; color:white;">關閉</button></div></div></div>

    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="data.js?v=6"></script>
    <script src="logic.js?v=6"></script>
    <script src="ui.js?v=6"></script>
</body>
</html>